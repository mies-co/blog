{"pageProps":{"content":"# JS Massive code reuse - part 1\n## Massive workspaces\n\n![JS Massive Code Reuse](/static/media/js-massive-code-reuse-cover.png)\n\nThis **Code reuse** series is composed of seven small posts:\n\n1. **Massive workspaces**\n2. **Massive git submodules (coming soon)**\n3. **Massive publishing to npm and github (coming soon)**\n4. **Massive secrets management (coming soon)**\n5. **Massive modularization of your code (coming soon)**\n6. **Massive bundling with rollup (coming soon)**\n7. **Massively scaling it up (coming soon)**\n\nThey all reveal a **very simple** workflow that I sharpened up for the last 4 years. It enables to manage highly reusable code we have been writing for international institutions but for small presentational websites as well. This series was written for developers who already know the basics of JS. \n\nI made this series as simple as possible, cutting it down to the bare minimum and removing all extraneous complexity, so yeah we end up with pretty easy stuff don't be surprised!\n\n### Why so massive?\n\nOf course it's **massive** to be catchy, but also because in my experience it can handle a lot of code without flaws.\n\n### What we will avoid\n\n- Setup webpack aliases\n- Starting from zero for each project\n- Manually edit stuff inside `node_modules`\n- Switch libraries/frameworks in desperation for maintainability and time saving\n- Spend hours debugging stuff caused by symlinks and inconsistent local packages dependencies\n\n## Motivation\n\nHow do we usually keep motivated as developers? We try new things (aka. the cool new JS gadget)!\nI believe there are better ways to stay motivated. But more importantly, there are simple ways to save time and stay motivated using the same libraries/frameworks for years.\n\nIn my opinon, libraries/frameworks are just tools to get the job done. Changing these tools too often is like nailing jello to a tree. You better keep them forever and sharpen them up! Here is the workflow that works for me, I hope it works for you too.\n\n## Workspaces\n\nA pretty amazing feature I stumbled upon a couple of years ago is Yarn Workspaces. Don't run away when I say `yarn` (it boomed then everyone went back to npm at some point), what follows is **not supported at all in npm**.\n\nThese workspaces will enable you to easily create and manage hundreds of local packages than can be reused across all your projects. Basically you'll be able to easily \"convert\" everything to packages, eventually publish them to github or npm, and install them anywhere.\n\nHere is our future project hierarchy:\n\n```js\n// Our top level parent directory\nfederator\n.\nâ”‚    // Workspace of our first app\nâ”œâ”€â”€ app-alpha\nâ”‚   â””â”€â”€ package.json\nâ”‚\nâ”‚   // Workspace of packages to be consumed by the client\nâ”œâ”€â”€ packs-client\nâ”‚   â””â”€â”€ package.json\nâ”‚\nâ”‚   // Workspace of packages to be consumed by the server\nâ”œâ”€â”€ packs-server\nâ”‚   â””â”€â”€ package.json\nâ”‚\nâ”‚   // Contains the definition of our workspaces\nâ””â”€â”€ package.json\n```\n\nBy workspace, I mean the directory that is treated as a workspace by yarn (more explanation below).\n\n### Install yarn\n\nPlease follow the [official instructions to install yarn](https://classic.yarnpkg.com/en/docs/install) or specific instructions to use it with `nvm` (you should install it without including `node` then).\n\n### Configure workspaces\n\nIn **federator/package.json**\n\nCreate a `workspaces` object that defines which of the children directories is a workspace to be handled by lerna.\n\n```json\n{\n\t\"name\": \"federator\",\n\t\"description\": \"Manages (almost) all codes of the company ðŸ˜Ž\",\n\t\"version\": \"0.0.1\",\n\t\"license\": \"MIT\",\n\t\"private\": true,\n\t\"workspaces\": {\n\t\t\"packages\": [\n\t\t\t\"app-*\",\n\t\t\t\"packs-*\"\n\t\t],\n\t\t\"nohoist\": []\n\t},\n\t\"dependencies\": {},\n\t\"devDependencies\": {}\n}\n```\n\nIn **packs-server/package.json**\n\n```json\n{\n\t\"name\": \"packs-server\",\n\t\"version\": \"0.0.1\",\n\t\"license\": \"MIT\",\n\t\"dependencies\": {\n\t\t\"lodash\": \"4.17.20\"\n\t}\n}\n```\n\nIn **packs-client/package.json**\n\n```json\n{\n\t\"name\": \"packs-client\",\n\t\"version\": \"0.0.1\",\n\t\"license\": \"MIT\",\n\t\"dependencies\": {\n\t\t\"lodash\": \"4.17.20\"\n\t}\n}\n```\n\nIn **app-alpha/package.json**\n\n```json\n{\n\t\"name\": \"app-alpha\",\n\t\"version\": \"0.0.1\",\n\t\"license\": \"MIT\",\n\t\"dependencies\": {\n\t\t\"lodash\": \"4.17.20\"\n\t}\n}\n```\n\n### Install dependencies\n\nNow that all our packages were created, open the terminal, and run the following command in `federator/`:\n\n```sh\nyarn\n```\n\nYou will notice that the following workspaces have no `node_modules`!\n\n- `app-alpha/`\n- `packs-client/`\n- `packs-server/`\n\nThat's absolutely normal. The common dependencies (only `lodash` for now), have been installed higher in the hierarchy, in `federator/node_modules/`. This is called [hoisting](https://classic.yarnpkg.com/blog/2018/02/15/nohoist/).\n\n### **Yes, our workspaces are already fully setup and working! ðŸŽ‰**\n\n[Follow me on Twitter](https://twitter.com/astenmies) to be kept updated when **Part 2 - Massive version management** comes out. That would also help to get me started because I'm new to Twitter.\n\n","frontmatter":{"title":"JS Massive code reuse - part 1","subtitle":"Massive workspaces","description":"Reuse massive amounts of code in all your projects","language":"js","author":{"firstname":"Asten","lastname":"Mies","twitter":"astenmies"},"social":{"image":"https://blog.mies.co/static/media/js-massive-code-reuse-twitter.png"},"tags":["javascript","modules","developers"],"dateCreated":"2020-08-22T00:00:00.000Z","dateUpdated":"2020-08-22T00:00:00.000Z","dateLast":"2020-08-22T00:00:00.000Z","dateCreatedHuman":"22 Aug 2020","dateUpdatedHuman":"22 Aug 2020","dateLastHuman":"22 Aug 2020"}},"__N_SSG":true}